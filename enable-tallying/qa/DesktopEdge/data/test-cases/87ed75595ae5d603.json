{"uid":"87ed75595ae5d603","name":"test_vaccination_file_upload_systmone_whitespace_normalization","fullName":"tests.test_import_systmone_nivs#test_vaccination_file_upload_systmone_whitespace_normalization","historyId":"ff5fad998d0535e218d9303131be0a6d","time":{"start":1762535528653,"stop":1762535618876,"duration":90223},"description":"\nTest: Upload a SystmOne vaccination records file with extra whitespace and\n   verify normalization.\nSteps:\n1. Upload a SystmOne file with whitespace issues.\nVerification:\n- Output indicates successful normalization and import.\nScenarios covered:\nTwoSpaces, Tabs, NBSP (non-breaking space), ZWJ (zero-width joiner),\nHistoricalTwoSpaces, HistoricalTabs, HistoricalNBSP, HistoricalZWJ\n","descriptionHtml":"<p>Test: Upload a SystmOne vaccination records file with extra whitespace and<br />\nverify normalization.<br />\nSteps:</p>\n<ol>\n<li>Upload a SystmOne file with whitespace issues.<br />\nVerification:</li>\n</ol>\n<ul>\n<li>Output indicates successful normalization and import.<br />\nScenarios covered:<br />\nTwoSpaces, Tabs, NBSP (non-breaking space), ZWJ (zero-width joiner),<br />\nHistoricalTwoSpaces, HistoricalTabs, HistoricalNBSP, HistoricalZWJ</li>\n</ul>\n","status":"failed","statusMessage":"AssertionError: Locator expected to be visible\nActual value: <element(s) not found> \nCall log:\n  - Expect \"to_be_visible\" with timeout 5000ms\n  - waiting for get_by_role(\"strong\").get_by_text(\"Completed\").or_(get_by_role(\"strong\").get_by_text(\"Invalid\"))","statusTrace":"setup_systmone_nivs = None\nimport_records_page = <mavis.test.pages.import_records.ImportRecordsPage object at 0x7fac4f148050>\n\n    @pytest.mark.vaccinations\n    @pytest.mark.bug\n    def test_vaccination_file_upload_systmone_whitespace_normalization(\n        setup_systmone_nivs,\n        import_records_page,\n    ):\n        \"\"\"\n        Test: Upload a SystmOne vaccination records file with extra whitespace and\n           verify normalization.\n        Steps:\n        1. Upload a SystmOne file with whitespace issues.\n        Verification:\n        - Output indicates successful normalization and import.\n        Scenarios covered:\n        TwoSpaces, Tabs, NBSP (non-breaking space), ZWJ (zero-width joiner),\n        HistoricalTwoSpaces, HistoricalTabs, HistoricalNBSP, HistoricalZWJ\n        \"\"\"\n>       import_records_page.upload_and_verify_output(\n            VaccsFileMapping.SYSTMONE_WHITESPACE,\n        )\n\ntests/test_import_systmone_nivs.py:101: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmavis/test/pages/import_records.py:139: in upload_and_verify_output\n    self.wait_for_processed()\nmavis/test/pages/import_records.py:87: in wait_for_processed\n    reload_until_element_is_visible(self.page, tag, seconds=60)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\npage = <Page url='https://qa.mavistesting.com/immunisation-imports/1082043'>\ntag = <Locator frame=<Frame name= url='https://qa.mavistesting.com/immunisation-imports/1082043'> selector='internal:role=strong >> internal:text=\"Completed\"i >> internal:or=\"internal:role=strong >> internal:text=\\\\\"Invalid\\\\\"i\"'>\nseconds = 60\n\n    def reload_until_element_is_visible(\n        page: Page, tag: Locator, seconds: int = DEFAULT_TIMEOUT_SECONDS\n    ) -> None:\n        for _ in range(seconds * 2):\n            if tag.is_visible():\n                break\n    \n            time.sleep(0.5)\n    \n            page.reload()\n        else:\n>           expect(tag).to_be_visible()\nE           AssertionError: Locator expected to be visible\nE           Actual value: <element(s) not found> \nE           Call log:\nE             - Expect \"to_be_visible\" with timeout 5000ms\nE             - waiting for get_by_role(\"strong\").get_by_text(\"Completed\").or_(get_by_role(\"strong\").get_by_text(\"Invalid\"))\n\nmavis/test/utils.py:171: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_artifacts_recorder","time":{"start":1762535525667,"stop":1762535525668,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"output_path","time":{"start":1762535525667,"stop":1762535525667,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"context","time":{"start":1762535525668,"stop":1762535525673,"duration":5},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"new_context","time":{"start":1762535525668,"stop":1762535525668,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"page","time":{"start":1762535525673,"stop":1762535525699,"duration":26},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"flipper_page","time":{"start":1762535525699,"stop":1762535525699,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"set_feature_flags","time":{"start":1762535525699,"stop":1762535525699,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"log_in_page","time":{"start":1762535525699,"stop":1762535525700,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"log_in_as_nurse","time":{"start":1762535525700,"stop":1762535527417,"duration":1717},"status":"passed","steps":[{"name":"Go to log in page","time":{"start":1762535525700,"stop":1762535526691,"duration":991},"status":"passed","steps":[{"name":"Go to log in page","time":{"start":1762535525700,"stop":1762535526691,"duration":991},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Log in as User(username='lpatel@example.net', password='lpatel@example.net', role='nurse') and choose team Team(name='Parkes-Garner est. 1635', workgroup='U983A', careplus_venue_code='U983A', email='kimberley23@example.com', phone='+447700 900641')","time":{"start":1762535526691,"stop":1762535527417,"duration":726},"status":"passed","steps":[{"name":"Log in as {1} and choose team {2}","time":{"start":1762535526691,"stop":1762535527417,"duration":726},"status":"passed","steps":[{"name":"Log in as User(username='lpatel@example.net', password='lpatel@example.net', role='nurse')","time":{"start":1762535526691,"stop":1762535527380,"duration":689},"status":"passed","steps":[{"name":"Log in as {1}","time":{"start":1762535526691,"stop":1762535527380,"duration":689},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(User(username='lpatel@example.net', password='lpatel@example.net', role='nurse'),)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(User(username='lpatel@example.net', password='lpatel@example.net', role='nurse'), Team(name='Parkes-Garner est. 1635', workgroup='U983A', careplus_venue_code='U983A', email='kimberley23@example.com', phone='+447700 900641'))"}],"shouldDisplayMessage":false,"stepsCount":3,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":6,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"children","time":{"start":1762535527417,"stop":1762535527422,"duration":5},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dashboard_page","time":{"start":1762535527417,"stop":1762535527417,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_data","time":{"start":1762535527422,"stop":1762535527423,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"import_records_page","time":{"start":1762535527424,"stop":1762535527424,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"setup_systmone_nivs","time":{"start":1762535527424,"stop":1762535528653,"duration":1229},"status":"passed","steps":[{"name":"Click on Manage vaccinations in schools","time":{"start":1762535527424,"stop":1762535527579,"duration":155},"status":"passed","steps":[{"name":"Click on Manage vaccinations in schools","time":{"start":1762535527424,"stop":1762535527579,"duration":155},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Import Records","time":{"start":1762535527579,"stop":1762535527762,"duration":183},"status":"passed","steps":[{"name":"Click on Import Records","time":{"start":1762535527579,"stop":1762535527762,"duration":183},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Import Records","time":{"start":1762535527762,"stop":1762535528196,"duration":434},"status":"passed","steps":[{"name":"Click on Import Records","time":{"start":1762535527762,"stop":1762535528196,"duration":434},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Select Vaccination Records","time":{"start":1762535528196,"stop":1762535528247,"duration":51},"status":"passed","steps":[{"name":"Select Vaccination Records","time":{"start":1762535528197,"stop":1762535528247,"duration":50},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1762535528247,"stop":1762535528653,"duration":406},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1762535528247,"stop":1762535528653,"duration":406},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":10,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"testStage":{"description":"\nTest: Upload a SystmOne vaccination records file with extra whitespace and\n   verify normalization.\nSteps:\n1. Upload a SystmOne file with whitespace issues.\nVerification:\n- Output indicates successful normalization and import.\nScenarios covered:\nTwoSpaces, Tabs, NBSP (non-breaking space), ZWJ (zero-width joiner),\nHistoricalTwoSpaces, HistoricalTabs, HistoricalNBSP, HistoricalZWJ\n","status":"failed","statusMessage":"AssertionError: Locator expected to be visible\nActual value: <element(s) not found> \nCall log:\n  - Expect \"to_be_visible\" with timeout 5000ms\n  - waiting for get_by_role(\"strong\").get_by_text(\"Completed\").or_(get_by_role(\"strong\").get_by_text(\"Invalid\"))","statusTrace":"setup_systmone_nivs = None\nimport_records_page = <mavis.test.pages.import_records.ImportRecordsPage object at 0x7fac4f148050>\n\n    @pytest.mark.vaccinations\n    @pytest.mark.bug\n    def test_vaccination_file_upload_systmone_whitespace_normalization(\n        setup_systmone_nivs,\n        import_records_page,\n    ):\n        \"\"\"\n        Test: Upload a SystmOne vaccination records file with extra whitespace and\n           verify normalization.\n        Steps:\n        1. Upload a SystmOne file with whitespace issues.\n        Verification:\n        - Output indicates successful normalization and import.\n        Scenarios covered:\n        TwoSpaces, Tabs, NBSP (non-breaking space), ZWJ (zero-width joiner),\n        HistoricalTwoSpaces, HistoricalTabs, HistoricalNBSP, HistoricalZWJ\n        \"\"\"\n>       import_records_page.upload_and_verify_output(\n            VaccsFileMapping.SYSTMONE_WHITESPACE,\n        )\n\ntests/test_import_systmone_nivs.py:101: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmavis/test/pages/import_records.py:139: in upload_and_verify_output\n    self.wait_for_processed()\nmavis/test/pages/import_records.py:87: in wait_for_processed\n    reload_until_element_is_visible(self.page, tag, seconds=60)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\npage = <Page url='https://qa.mavistesting.com/immunisation-imports/1082043'>\ntag = <Locator frame=<Frame name= url='https://qa.mavistesting.com/immunisation-imports/1082043'> selector='internal:role=strong >> internal:text=\"Completed\"i >> internal:or=\"internal:role=strong >> internal:text=\\\\\"Invalid\\\\\"i\"'>\nseconds = 60\n\n    def reload_until_element_is_visible(\n        page: Page, tag: Locator, seconds: int = DEFAULT_TIMEOUT_SECONDS\n    ) -> None:\n        for _ in range(seconds * 2):\n            if tag.is_visible():\n                break\n    \n            time.sleep(0.5)\n    \n            page.reload()\n        else:\n>           expect(tag).to_be_visible()\nE           AssertionError: Locator expected to be visible\nE           Actual value: <element(s) not found> \nE           Call log:\nE             - Expect \"to_be_visible\" with timeout 5000ms\nE             - waiting for get_by_role(\"strong\").get_by_text(\"Completed\").or_(get_by_role(\"strong\").get_by_text(\"Invalid\"))\n\nmavis/test/utils.py:171: AssertionError","steps":[{"name":"Set input file to PosixPath('working/VaccsFileMapping.SYSTMONE_WHITESPACE20251107171208.csv')","time":{"start":1762535528664,"stop":1762535528682,"duration":18},"status":"passed","steps":[{"name":"Set input file to {1}","time":{"start":1762535528664,"stop":1762535528682,"duration":18},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(PosixPath('working/VaccsFileMapping.SYSTMONE_WHITESPACE20251107171208.csv'),)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1762535529683,"stop":1762535529975,"duration":292},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1762535529683,"stop":1762535529975,"duration":292},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"_coverage","value":"'TwoSpaces, Tabs, NBSP, ZWJ, HistoricalTwoSpaces, HistoricalTabs, HistoricalNBSP, HistoricalZWJ'"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click link with uploaded datetime","time":{"start":1762535530006,"stop":1762535530233,"duration":227},"status":"passed","steps":[{"name":"Click link with uploaded datetime","time":{"start":1762535530006,"stop":1762535530233,"duration":227},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":6,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"log_in_as_nurse::0","time":{"start":1762535618884,"stop":1762535619277,"duration":393},"status":"passed","steps":[{"name":"Log out","time":{"start":1762535618884,"stop":1762535619277,"duration":393},"status":"passed","steps":[{"name":"Log out","time":{"start":1762535618884,"stop":1762535619277,"duration":393},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"set_feature_flags::0","time":{"start":1762535619278,"stop":1762535619278,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"new_context::0","time":{"start":1762535619279,"stop":1762535619289,"duration":10},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_artifacts_recorder::0","time":{"start":1762535619290,"stop":1762535619290,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"bug"},{"name":"tag","value":"vaccinations"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_import_systmone_nivs"},{"name":"host","value":"runnervmf2e7y"},{"name":"thread","value":"3105-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_import_systmone_nivs"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[]}],"tags":["vaccinations","bug"]},"source":"87ed75595ae5d603.json","parameterValues":[]}
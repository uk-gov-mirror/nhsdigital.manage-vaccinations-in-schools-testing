{"uid":"5e06b5a0f836ffca","name":"test_gillick_competence_notes","fullName":"tests.test_verbal_consent#test_gillick_competence_notes","historyId":"27d1d369e43b87fe9fe428ac7b381a74","time":{"start":1762535598763,"stop":1762535598763,"duration":0},"description":"\nTest: Validate Gillick competence assessment notes length and update.\nSteps:\n1. Open the session for the school and programme.\n2. Navigate to Gillick competence assessment for the child.\n3. Attempt to complete assessment with notes over 1000 characters (should error).\n4. Complete assessment with valid notes.\n5. Edit assessment and again try to update with notes over 1000\n   characters (should error).\nVerification:\n- Error is shown for notes over 1000 characters.\n- Assessment can be completed and updated with valid notes.\n","descriptionHtml":"<p>Test: Validate Gillick competence assessment notes length and update.<br />\nSteps:</p>\n<ol>\n<li>Open the session for the school and programme.</li>\n<li>Navigate to Gillick competence assessment for the child.</li>\n<li>Attempt to complete assessment with notes over 1000 characters (should error).</li>\n<li>Complete assessment with valid notes.</li>\n<li>Edit assessment and again try to update with notes over 1000<br />\ncharacters (should error).<br />\nVerification:</li>\n</ol>\n<ul>\n<li>Error is shown for notes over 1000 characters.</li>\n<li>Assessment can be completed and updated with valid notes.</li>\n</ul>\n","status":"failed","statusMessage":"AssertionError: Locator expected to be visible\nActual value: <element(s) not found> \nCall log:\n  - Expect \"to_be_visible\" with timeout 5000ms\n  - waiting for get_by_role(\"strong\").get_by_text(\"Completed\").or_(get_by_role(\"strong\").get_by_text(\"Invalid\"))","statusTrace":"setup_session_with_file_upload = <function setup_session_with_file_upload.<locals>._setup at 0x7fa34d3ee560>\n\n    @pytest.fixture\n    def setup_fixed_child(setup_session_with_file_upload):\n>       yield from setup_session_with_file_upload(CohortsFileMapping.FIXED_CHILD)\n\ntests/test_verbal_consent.py:46: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/test_verbal_consent.py:31: in _setup\n    import_records_page.import_class_list(class_list_file, year_group)\nmavis/test/pages/import_records.py:190: in import_class_list\n    self.upload_and_verify_output(class_list_file, programme_group=programme_group)\nmavis/test/pages/import_records.py:139: in upload_and_verify_output\n    self.wait_for_processed()\nmavis/test/pages/import_records.py:87: in wait_for_processed\n    reload_until_element_is_visible(self.page, tag, seconds=60)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\npage = <Page url='https://qa.mavistesting.com/sessions?q=&%5Bprogrammes%5D%5B%5D=&status=&type='>\ntag = <Locator frame=<Frame name= url='https://qa.mavistesting.com/sessions?q=&%5Bprogrammes%5D%5B%5D=&status=&type='> selec...ernal:role=strong >> internal:text=\"Completed\"i >> internal:or=\"internal:role=strong >> internal:text=\\\\\"Invalid\\\\\"i\"'>\nseconds = 60\n\n    def reload_until_element_is_visible(\n        page: Page, tag: Locator, seconds: int = DEFAULT_TIMEOUT_SECONDS\n    ) -> None:\n        for _ in range(seconds * 2):\n            if tag.is_visible():\n                break\n    \n            time.sleep(0.5)\n    \n            page.reload()\n        else:\n>           expect(tag).to_be_visible()\nE           AssertionError: Locator expected to be visible\nE           Actual value: <element(s) not found> \nE           Call log:\nE             - Expect \"to_be_visible\" with timeout 5000ms\nE             - waiting for get_by_role(\"strong\").get_by_text(\"Completed\").or_(get_by_role(\"strong\").get_by_text(\"Invalid\"))\n\nmavis/test/utils.py:171: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":1,"retriesStatusChange":false,"beforeStages":[{"name":"sessions_page","time":{"start":1762535600545,"stop":1762535600545,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dashboard_page","time":{"start":1762535600545,"stop":1762535600545,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"children","time":{"start":1762535600546,"stop":1762535600549,"duration":3},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_data","time":{"start":1762535600549,"stop":1762535600550,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"setup_fixed_child","time":{"start":1762535600550,"stop":1762535690295,"duration":89745},"status":"failed","statusMessage":"AssertionError: Locator expected to be visible\nActual value: <element(s) not found> \nCall log:\n  - Expect \"to_be_visible\" with timeout 5000ms\n  - waiting for get_by_role(\"strong\").get_by_text(\"Completed\").or_(get_by_role(\"strong\").get_by_text(\"Invalid\"))\n\n","statusTrace":"  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    teardown.throw(exception)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/_pytest/setuponly.py\", line 36, in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/pluggy/_callers.py\", line 121, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/_pytest/fixtures.py\", line 1196, in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/_pytest/fixtures.py\", line 923, in call_fixture_func\n    fixture_result = next(generator)\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/tests/test_verbal_consent.py\", line 46, in setup_fixed_child\n    yield from setup_session_with_file_upload(CohortsFileMapping.FIXED_CHILD)\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/tests/test_verbal_consent.py\", line 31, in _setup\n    import_records_page.import_class_list(class_list_file, year_group)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/mavis/test/pages/import_records.py\", line 190, in import_class_list\n    self.upload_and_verify_output(class_list_file, programme_group=programme_group)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/mavis/test/pages/import_records.py\", line 139, in upload_and_verify_output\n    self.wait_for_processed()\n    ~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/mavis/test/pages/import_records.py\", line 87, in wait_for_processed\n    reload_until_element_is_visible(self.page, tag, seconds=60)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/mavis/test/utils.py\", line 171, in reload_until_element_is_visible\n    expect(tag).to_be_visible()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/sync_api/_generated.py\", line 20424, in to_be_visible\n    self._sync(self._impl_obj.to_be_visible(visible=visible, timeout=timeout))\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/_impl/_sync_base.py\", line 115, in _sync\n    return task.result()\n           ~~~~~~~~~~~^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/_impl/_assertions.py\", line 763, in to_be_visible\n    await self._expect_impl(\n    ...<5 lines>...\n    )\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/_impl/_assertions.py\", line 83, in _expect_impl\n    raise AssertionError(\n        f\"{out_message}\\nActual value: {actual} {format_call_log(result.get('log'))}\"\n    )\n","steps":[{"name":"Click on Sessions","time":{"start":1762535600550,"stop":1762535600737,"duration":187},"status":"passed","steps":[{"name":"Click on Sessions","time":{"start":1762535600550,"stop":1762535600737,"duration":187},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on 'HPV' session at School(name='GEMS Cambridge International School, Abu Dhabi', urn='149183', site=None)","time":{"start":1762535600737,"stop":1762535601285,"duration":548},"status":"passed","steps":[{"name":"Click on {2} session at {1}","time":{"start":1762535600737,"stop":1762535601285,"duration":548},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(School(name='GEMS Cambridge International School, Abu Dhabi', urn='149183', site=None), <Programme.HPV: 'HPV'>)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Manage vaccinations in schools","time":{"start":1762535601290,"stop":1762535601449,"duration":159},"status":"passed","steps":[{"name":"Click on Manage vaccinations in schools","time":{"start":1762535601290,"stop":1762535601449,"duration":159},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Sessions","time":{"start":1762535601449,"stop":1762535601651,"duration":202},"status":"passed","steps":[{"name":"Click on Sessions","time":{"start":1762535601449,"stop":1762535601651,"duration":202},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on 'HPV' session at School(name='GEMS Cambridge International School, Abu Dhabi', urn='149183', site=None)","time":{"start":1762535601651,"stop":1762535602146,"duration":495},"status":"passed","steps":[{"name":"Click on {2} session at {1}","time":{"start":1762535601651,"stop":1762535602146,"duration":495},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(School(name='GEMS Cambridge International School, Abu Dhabi', urn='149183', site=None), <Programme.HPV: 'HPV'>)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Import class lists","time":{"start":1762535602146,"stop":1762535602436,"duration":290},"status":"passed","steps":[{"name":"Click on Import class lists","time":{"start":1762535602146,"stop":1762535602435,"duration":289},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1762535602477,"stop":1762535602899,"duration":422},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1762535602477,"stop":1762535602899,"duration":422},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Set input file to PosixPath('working/CohortsFileMapping.FIXED_CHILD20251107171322.csv')","time":{"start":1762535602909,"stop":1762535602927,"duration":18},"status":"passed","steps":[{"name":"Set input file to {1}","time":{"start":1762535602909,"stop":1762535602927,"duration":18},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(PosixPath('working/CohortsFileMapping.FIXED_CHILD20251107171322.csv'),)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1762535603928,"stop":1762535604218,"duration":290},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1762535603928,"stop":1762535604218,"duration":290},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"_coverage","value":"None"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click link with uploaded datetime","time":{"start":1762535604248,"stop":1762535604436,"duration":188},"status":"passed","steps":[{"name":"Click link with uploaded datetime","time":{"start":1762535604248,"stop":1762535604436,"duration":188},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Go to dashboard","time":{"start":1762535689403,"stop":1762535689539,"duration":136},"status":"passed","steps":[{"name":"Go to dashboard","time":{"start":1762535689403,"stop":1762535689539,"duration":136},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Manage vaccinations in schools","time":{"start":1762535689540,"stop":1762535689715,"duration":175},"status":"passed","steps":[{"name":"Click on Manage vaccinations in schools","time":{"start":1762535689540,"stop":1762535689715,"duration":175},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Sessions","time":{"start":1762535689715,"stop":1762535689934,"duration":219},"status":"passed","steps":[{"name":"Click on Sessions","time":{"start":1762535689715,"stop":1762535689934,"duration":219},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":26,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"import_records_page","time":{"start":1762535600550,"stop":1762535600550,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"setup_session_with_file_upload","time":{"start":1762535600550,"stop":1762535600550,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[],"labels":[{"name":"tag","value":"consent"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_verbal_consent"},{"name":"host","value":"runnervmf2e7y"},{"name":"thread","value":"3108-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_verbal_consent"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[{"name":"MAV-955","url":"https://nhsd-jira.digital.nhs.uk/browse/MAV-955","type":"issue"}],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"8969b07f79c59efa","status":"failed","statusDetails":"AssertionError: Locator expected to be visible\nActual value: <element(s) not found> \nCall log:\n  - Expect \"to_be_visible\" with timeout 5000ms\n  - waiting for get_by_role(\"strong\").get_by_text(\"Completed\").or_(get_by_role(\"strong\").get_by_text(\"Invalid\"))","time":{"start":1762535506460,"stop":1762535506460,"duration":0}}],"categories":[{"name":"Product defects","matchedStatuses":[]}],"tags":["consent"]},"source":"5e06b5a0f836ffca.json","parameterValues":[]}
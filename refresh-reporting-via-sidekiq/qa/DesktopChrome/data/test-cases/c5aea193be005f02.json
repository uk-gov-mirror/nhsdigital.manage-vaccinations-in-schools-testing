{"uid":"c5aea193be005f02","name":"test_flu_consent_method_displayed_correctly[consents: (<ConsentOption.NASAL_SPRAY_OR_INJECTION: ''>, <ConsentOption.INJECTION: 'Injection'>, <ConsentOption.INJECTION: 'Injection'>)]","fullName":"tests.test_online_consent_flu#test_flu_consent_method_displayed_correctly","historyId":"686c46c6812e132053d3c949f28f70f3","time":{"start":1762524599296,"stop":1762524599296,"duration":0},"description":"\nTest: Submit multiple online flu consent forms with different methods and\n   verify the correct method is displayed in the session.\nSteps:\n1. Fill in child and parent details and submit consent with the first method.\n2. Submit a second consent for the same child with the\n   second method (different parent).\n3. Navigate to the session and consent tab.\n4. Search for the child and verify the correct consent method is shown.\n5. Verify the pattern of consent details text in the offline excel.\nVerification:\n- The consent method displayed in the session matches the expected method\n  from the last consent.\n- The consent details in the excel download match the expected pattern.\n","descriptionHtml":"<p>Test: Submit multiple online flu consent forms with different methods and<br />\nverify the correct method is displayed in the session.<br />\nSteps:</p>\n<ol>\n<li>Fill in child and parent details and submit consent with the first method.</li>\n<li>Submit a second consent for the same child with the<br />\nsecond method (different parent).</li>\n<li>Navigate to the session and consent tab.</li>\n<li>Search for the child and verify the correct consent method is shown.</li>\n<li>Verify the pattern of consent details text in the offline excel.<br />\nVerification:</li>\n</ol>\n<ul>\n<li>The consent method displayed in the session matches the expected method<br />\nfrom the last consent.</li>\n<li>The consent details in the excel download match the expected pattern.</li>\n</ul>\n","status":"failed","statusMessage":"AssertionError: Locator expected to be visible\nActual value: <element(s) not found> \nCall log:\n  - Expect \"to_be_visible\" with timeout 5000ms\n  - waiting for get_by_role(\"strong\").get_by_text(\"Completed\").or_(get_by_role(\"strong\").get_by_text(\"Invalid\"))","statusTrace":"url_with_session_scheduled = '/consents/KspVyrhHrd/flu/start'\nlog_in_as_nurse = None\nschools = {'HPV': [School(name='Bury Park Educational Institute (Al - Hikmah Secondary School)', urn='134807', site=None), Schoo...paratory School\", urn='145567', site=None), School(name='St Joseph Catholic Primary School', urn='117465', site=None)]}\ndashboard_page = <mavis.test.pages.dashboard.DashboardPage object at 0x7f40d94aab70>\nsessions_page = <mavis.test.pages.sessions.SessionsPage object at 0x7f40d8403b60>\nimport_records_page = <mavis.test.pages.import_records.ImportRecordsPage object at 0x7f40d9c2d0f0>\nyear_groups = {'HPV': 11, 'MMR': 3, 'doubles': 11, 'flu': 0}\n\n    @pytest.fixture\n    def setup_session_with_file_upload(\n        url_with_session_scheduled,\n        log_in_as_nurse,\n        schools,\n        dashboard_page,\n        sessions_page,\n        import_records_page,\n        year_groups,\n    ):\n        school = schools[Programme.FLU][0]\n        year_group = year_groups[Programme.FLU]\n    \n        dashboard_page.click_mavis()\n        dashboard_page.click_sessions()\n        sessions_page.click_session_for_programme_group(school, Programme.FLU)\n        sessions_page.click_import_class_lists()\n>       import_records_page.import_class_list(\n            CohortsFileMapping.FIXED_CHILD,\n            year_group,\n            Programme.FLU.group,\n        )\n\ntests/test_online_consent_flu.py:41: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmavis/test/pages/import_records.py:190: in import_class_list\n    self.upload_and_verify_output(class_list_file, programme_group=programme_group)\nmavis/test/pages/import_records.py:139: in upload_and_verify_output\n    self.wait_for_processed()\nmavis/test/pages/import_records.py:87: in wait_for_processed\n    reload_until_element_is_visible(self.page, tag, seconds=60)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\npage = <Page url='https://qa.mavistesting.com/class-imports/1173091'>\ntag = <Locator frame=<Frame name= url='https://qa.mavistesting.com/class-imports/1173091'> selector='internal:role=strong >> internal:text=\"Completed\"i >> internal:or=\"internal:role=strong >> internal:text=\\\\\"Invalid\\\\\"i\"'>\nseconds = 60\n\n    def reload_until_element_is_visible(\n        page: Page, tag: Locator, seconds: int = DEFAULT_TIMEOUT_SECONDS\n    ) -> None:\n        for _ in range(seconds * 2):\n            if tag.is_visible():\n                break\n    \n            time.sleep(0.5)\n    \n            page.reload()\n        else:\n>           expect(tag).to_be_visible()\nE           AssertionError: Locator expected to be visible\nE           Actual value: <element(s) not found> \nE           Call log:\nE             - Expect \"to_be_visible\" with timeout 5000ms\nE             - waiting for get_by_role(\"strong\").get_by_text(\"Completed\").or_(get_by_role(\"strong\").get_by_text(\"Invalid\"))\n\nmavis/test/utils.py:171: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"base_url","time":{"start":1762524249537,"stop":1762524249537,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1762524249538,"stop":1762524249538,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_session_faker","time":{"start":1762524249538,"stop":1762524249539,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"programmes_enabled","time":{"start":1762524249539,"stop":1762524249539,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1762524249539,"stop":1762524249539,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"year_groups","time":{"start":1762524249539,"stop":1762524249539,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1762524249539,"stop":1762524249539,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"onboarding","time":{"start":1762524249539,"stop":1762524273272,"duration":23733},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"nurse","time":{"start":1762524273273,"stop":1762524273273,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"schools","time":{"start":1762524273273,"stop":1762524273273,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_team_after_tests","time":{"start":1762524273273,"stop":1762524273273,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_type_launch_args","time":{"start":1762524273273,"stop":1762524273273,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"team","time":{"start":1762524273273,"stop":1762524273273,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"playwright","time":{"start":1762524273273,"stop":1762524273576,"duration":303},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"device","time":{"start":1762524273576,"stop":1762524273576,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_type","time":{"start":1762524273576,"stop":1762524273577,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"launch_browser","time":{"start":1762524273577,"stop":1762524273577,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"connect_options","time":{"start":1762524273577,"stop":1762524273577,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser","time":{"start":1762524273577,"stop":1762524273679,"duration":102},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_pw_artifacts_folder","time":{"start":1762524273679,"stop":1762524273680,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_context_args","time":{"start":1762524273680,"stop":1762524273680,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"reset_before_each_module","time":{"start":1762524273681,"stop":1762524304201,"duration":30520},"status":"broken","statusMessage":"requests.exceptions.ConnectionError: HTTPSConnectionPool(host='qa.mavistesting.com', port=443): Read timed out.\n","statusTrace":"  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    teardown.throw(exception)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/_pytest/setuponly.py\", line 36, in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/pluggy/_callers.py\", line 121, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/_pytest/fixtures.py\", line 1196, in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/_pytest/fixtures.py\", line 930, in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/mavis/test/fixtures/models.py\", line 99, in reset_before_each_module\n    response = requests.delete(url, params={\"keep_itself\": \"true\"}, timeout=30)\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/requests/api.py\", line 157, in delete\n    return request(\"delete\", url, **kwargs)\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/requests/api.py\", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/requests/sessions.py\", line 589, in request\n    resp = self.send(prep, **send_kwargs)\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/requests/sessions.py\", line 746, in send\n    r.content\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/requests/models.py\", line 902, in content\n    self._content = b\"\".join(self.iter_content(CONTENT_CHUNK_SIZE)) or b\"\"\n                    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/requests/models.py\", line 826, in generate\n    raise ConnectionError(e)\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"basic_auth_token","time":{"start":1762524273681,"stop":1762524273681,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_context_args","time":{"start":1762524273681,"stop":1762524273681,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"basic_auth_credentials","time":{"start":1762524273681,"stop":1762524273681,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"reset_before_each_module","time":{"start":1762524304306,"stop":1762524327497,"duration":23191},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"organisation","time":{"start":1762524425353,"stop":1762524425353,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"clinics","time":{"start":1762524425353,"stop":1762524425353,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"new_context","time":{"start":1762524599296,"stop":1762524599296,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"context","time":{"start":1762524599296,"stop":1762524599302,"duration":6},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_artifacts_recorder","time":{"start":1762524599296,"stop":1762524599296,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"output_path","time":{"start":1762524599296,"stop":1762524599296,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"page","time":{"start":1762524599302,"stop":1762524599343,"duration":41},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dashboard_page","time":{"start":1762524599343,"stop":1762524599343,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"flipper_page","time":{"start":1762524599343,"stop":1762524599343,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"sessions_page","time":{"start":1762524599343,"stop":1762524599344,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"log_in_page","time":{"start":1762524599343,"stop":1762524599343,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"set_feature_flags","time":{"start":1762524599343,"stop":1762524599343,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"schedule_session_and_get_consent_url","time":{"start":1762524599344,"stop":1762524599344,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"url_with_session_scheduled","time":{"start":1762524599344,"stop":1762524603872,"duration":4528},"status":"passed","steps":[{"name":"Go to log in page","time":{"start":1762524599344,"stop":1762524600341,"duration":997},"status":"passed","steps":[{"name":"Go to log in page","time":{"start":1762524599344,"stop":1762524600341,"duration":997},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Log in as User(username='reecerees@example.org', password='reecerees@example.org', role='nurse') and choose team Team(name='Walker LLC est. 1955', workgroup='H068P', careplus_venue_code='H068P', email='alison74@example.com', phone='07700 900267')","time":{"start":1762524600341,"stop":1762524602675,"duration":2334},"status":"passed","steps":[{"name":"Log in as {1} and choose team {2}","time":{"start":1762524600341,"stop":1762524602675,"duration":2334},"status":"passed","steps":[{"name":"Log in as User(username='reecerees@example.org', password='reecerees@example.org', role='nurse')","time":{"start":1762524600341,"stop":1762524602648,"duration":2307},"status":"passed","steps":[{"name":"Log in as {1}","time":{"start":1762524600341,"stop":1762524602648,"duration":2307},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(User(username='reecerees@example.org', password='reecerees@example.org', role='nurse'),)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(User(username='reecerees@example.org', password='reecerees@example.org', role='nurse'), Team(name='Walker LLC est. 1955', workgroup='H068P', careplus_venue_code='H068P', email='alison74@example.com', phone='07700 900267'))"}],"shouldDisplayMessage":false,"stepsCount":3,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Sessions","time":{"start":1762524602675,"stop":1762524602898,"duration":223},"status":"passed","steps":[{"name":"Click on Sessions","time":{"start":1762524602675,"stop":1762524602898,"duration":223},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on 'flu' session at School(name=\"St Michael's Preparatory School\", urn='145567', site=None)","time":{"start":1762524602898,"stop":1762524603465,"duration":567},"status":"passed","steps":[{"name":"Click on {2} session at {1}","time":{"start":1762524602898,"stop":1762524603465,"duration":567},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(School(name=\"St Michael's Preparatory School\", urn='145567', site=None), 'flu')"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Log out","time":{"start":1762524603478,"stop":1762524603872,"duration":394},"status":"passed","steps":[{"name":"Log out","time":{"start":1762524603478,"stop":1762524603872,"duration":394},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":12,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"log_in_as_nurse","time":{"start":1762524603872,"stop":1762524605155,"duration":1283},"status":"passed","steps":[{"name":"Go to log in page","time":{"start":1762524603872,"stop":1762524603996,"duration":124},"status":"passed","steps":[{"name":"Go to log in page","time":{"start":1762524603873,"stop":1762524603996,"duration":123},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Log in as User(username='reecerees@example.org', password='reecerees@example.org', role='nurse') and choose team Team(name='Walker LLC est. 1955', workgroup='H068P', careplus_venue_code='H068P', email='alison74@example.com', phone='07700 900267')","time":{"start":1762524603996,"stop":1762524605155,"duration":1159},"status":"passed","steps":[{"name":"Log in as {1} and choose team {2}","time":{"start":1762524603996,"stop":1762524605155,"duration":1159},"status":"passed","steps":[{"name":"Log in as User(username='reecerees@example.org', password='reecerees@example.org', role='nurse')","time":{"start":1762524603996,"stop":1762524605134,"duration":1138},"status":"passed","steps":[{"name":"Log in as {1}","time":{"start":1762524603996,"stop":1762524605134,"duration":1138},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(User(username='reecerees@example.org', password='reecerees@example.org', role='nurse'),)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(User(username='reecerees@example.org', password='reecerees@example.org', role='nurse'), Team(name='Walker LLC est. 1955', workgroup='H068P', careplus_venue_code='H068P', email='alison74@example.com', phone='07700 900267'))"}],"shouldDisplayMessage":false,"stepsCount":3,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":6,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"children","time":{"start":1762524605155,"stop":1762524605159,"duration":4},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_data","time":{"start":1762524605159,"stop":1762524605160,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"import_records_page","time":{"start":1762524605160,"stop":1762524605160,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"setup_session_with_file_upload","time":{"start":1762524605160,"stop":1762524694577,"duration":89417},"status":"failed","statusMessage":"AssertionError: Locator expected to be visible\nActual value: <element(s) not found> \nCall log:\n  - Expect \"to_be_visible\" with timeout 5000ms\n  - waiting for get_by_role(\"strong\").get_by_text(\"Completed\").or_(get_by_role(\"strong\").get_by_text(\"Invalid\"))\n\n","statusTrace":"  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    teardown.throw(exception)\n    ~~~~~~~~~~~~~~^^^^^^^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/_pytest/setuponly.py\", line 36, in pytest_fixture_setup\n    return (yield)\n            ^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/pluggy/_callers.py\", line 121, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/_pytest/fixtures.py\", line 1196, in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/_pytest/fixtures.py\", line 930, in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/tests/test_online_consent_flu.py\", line 41, in setup_session_with_file_upload\n    import_records_page.import_class_list(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        CohortsFileMapping.FIXED_CHILD,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        year_group,\n        ^^^^^^^^^^^\n        Programme.FLU.group,\n        ^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/mavis/test/pages/import_records.py\", line 190, in import_class_list\n    self.upload_and_verify_output(class_list_file, programme_group=programme_group)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/mavis/test/pages/import_records.py\", line 139, in upload_and_verify_output\n    self.wait_for_processed()\n    ~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/mavis/test/pages/import_records.py\", line 87, in wait_for_processed\n    reload_until_element_is_visible(self.page, tag, seconds=60)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/mavis/test/utils.py\", line 171, in reload_until_element_is_visible\n    expect(tag).to_be_visible()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/sync_api/_generated.py\", line 20424, in to_be_visible\n    self._sync(self._impl_obj.to_be_visible(visible=visible, timeout=timeout))\n    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/_impl/_sync_base.py\", line 115, in _sync\n    return task.result()\n           ~~~~~~~~~~~^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/_impl/_assertions.py\", line 763, in to_be_visible\n    await self._expect_impl(\n    ...<5 lines>...\n    )\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/_impl/_assertions.py\", line 83, in _expect_impl\n    raise AssertionError(\n        f\"{out_message}\\nActual value: {actual} {format_call_log(result.get('log'))}\"\n    )\n","steps":[{"name":"Click on Manage vaccinations in schools","time":{"start":1762524605160,"stop":1762524605319,"duration":159},"status":"passed","steps":[{"name":"Click on Manage vaccinations in schools","time":{"start":1762524605160,"stop":1762524605319,"duration":159},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Sessions","time":{"start":1762524605319,"stop":1762524605520,"duration":201},"status":"passed","steps":[{"name":"Click on Sessions","time":{"start":1762524605319,"stop":1762524605520,"duration":201},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on 'flu' session at School(name=\"St Michael's Preparatory School\", urn='145567', site=None)","time":{"start":1762524605520,"stop":1762524606171,"duration":651},"status":"passed","steps":[{"name":"Click on {2} session at {1}","time":{"start":1762524605520,"stop":1762524606171,"duration":651},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(School(name=\"St Michael's Preparatory School\", urn='145567', site=None), <Programme.FLU: 'flu'>)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Import class lists","time":{"start":1762524606171,"stop":1762524606471,"duration":300},"status":"passed","steps":[{"name":"Click on Import class lists","time":{"start":1762524606171,"stop":1762524606471,"duration":300},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1762524606531,"stop":1762524606972,"duration":441},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1762524606531,"stop":1762524606972,"duration":441},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Set input file to PosixPath('working/CohortsFileMapping.FIXED_CHILD20251107141006.csv')","time":{"start":1762524606982,"stop":1762524607001,"duration":19},"status":"passed","steps":[{"name":"Set input file to {1}","time":{"start":1762524606982,"stop":1762524607001,"duration":19},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(PosixPath('working/CohortsFileMapping.FIXED_CHILD20251107141006.csv'),)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1762524608001,"stop":1762524608337,"duration":336},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1762524608001,"stop":1762524608337,"duration":336},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"_coverage","value":"None"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click link with uploaded datetime","time":{"start":1762524608368,"stop":1762524608537,"duration":169},"status":"passed","steps":[{"name":"Click link with uploaded datetime","time":{"start":1762524608368,"stop":1762524608537,"duration":169},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":16,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"start_consent_with_session_scheduled","time":{"start":1762524741566,"stop":1762524742242,"duration":676},"status":"passed","steps":[{"name":"Click on start button","time":{"start":1762524741855,"stop":1762524742242,"duration":387},"status":"passed","steps":[{"name":"Click on start button","time":{"start":1762524741855,"stop":1762524742242,"duration":387},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"start_page","time":{"start":1762524741566,"stop":1762524741566,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"online_consent_page","time":{"start":1762524742242,"stop":1762524742243,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[{"name":"log_in_as_nurse::0","time":{"start":1762524694589,"stop":1762524694972,"duration":383},"status":"passed","steps":[{"name":"Log out","time":{"start":1762524694589,"stop":1762524694972,"duration":383},"status":"passed","steps":[{"name":"Log out","time":{"start":1762524694589,"stop":1762524694972,"duration":383},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"url_with_session_scheduled::0","time":{"start":1762524694972,"stop":1762524697189,"duration":2217},"status":"passed","steps":[{"name":"Go to log in page","time":{"start":1762524694973,"stop":1762524695096,"duration":123},"status":"passed","steps":[{"name":"Go to log in page","time":{"start":1762524694973,"stop":1762524695096,"duration":123},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Log in as User(username='reecerees@example.org', password='reecerees@example.org', role='nurse') and choose team Team(name='Walker LLC est. 1955', workgroup='H068P', careplus_venue_code='H068P', email='alison74@example.com', phone='07700 900267')","time":{"start":1762524695096,"stop":1762524696259,"duration":1163},"status":"passed","steps":[{"name":"Log in as {1} and choose team {2}","time":{"start":1762524695096,"stop":1762524696259,"duration":1163},"status":"passed","steps":[{"name":"Log in as User(username='reecerees@example.org', password='reecerees@example.org', role='nurse')","time":{"start":1762524695096,"stop":1762524696239,"duration":1143},"status":"passed","steps":[{"name":"Log in as {1}","time":{"start":1762524695096,"stop":1762524696239,"duration":1143},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(User(username='reecerees@example.org', password='reecerees@example.org', role='nurse'),)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(User(username='reecerees@example.org', password='reecerees@example.org', role='nurse'), Team(name='Walker LLC est. 1955', workgroup='H068P', careplus_venue_code='H068P', email='alison74@example.com', phone='07700 900267'))"}],"shouldDisplayMessage":false,"stepsCount":3,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Sessions","time":{"start":1762524696259,"stop":1762524696469,"duration":210},"status":"passed","steps":[{"name":"Click on Sessions","time":{"start":1762524696259,"stop":1762524696469,"duration":210},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Log out","time":{"start":1762524696769,"stop":1762524697189,"duration":420},"status":"passed","steps":[{"name":"Log out","time":{"start":1762524696769,"stop":1762524697189,"duration":420},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":10,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"new_context::0","time":{"start":1762524697191,"stop":1762524697201,"duration":10},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"set_feature_flags::0","time":{"start":1762524697191,"stop":1762524697191,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_artifacts_recorder::0","time":{"start":1762524697202,"stop":1762524697202,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_pw_artifacts_folder::0","time":{"start":1762525257825,"stop":1762525257825,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser::0","time":{"start":1762525257826,"stop":1762525257849,"duration":23},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"playwright::0","time":{"start":1762525257851,"stop":1762525257862,"duration":11},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_team_after_tests::0","time":{"start":1762525257863,"stop":1762525258185,"duration":322},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"consent"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_online_consent_flu"},{"name":"host","value":"runnervmf2e7y"},{"name":"thread","value":"3097-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_online_consent_flu"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"consents","value":"(<ConsentOption.NASAL_SPRAY_OR_INJECTION: ''>, <ConsentOption.INJECTION: 'Injection'>, <ConsentOption.INJECTION: 'Injection'>)"}],"links":[{"name":"MAV-2025","url":"https://nhsd-jira.digital.nhs.uk/browse/MAV-2025","type":"issue"},{"name":"MAV-1234","url":"https://nhsd-jira.digital.nhs.uk/browse/MAV-1234","type":"issue"}],"hidden":true,"retry":true,"extra":{"categories":[],"tags":["consent"]},"source":"c5aea193be005f02.json","parameterValues":["(<ConsentOption.NASAL_SPRAY_OR_INJECTION: ''>, <ConsentOption.INJECTION: 'Injection'>, <ConsentOption.INJECTION: 'Injection'>)"]}